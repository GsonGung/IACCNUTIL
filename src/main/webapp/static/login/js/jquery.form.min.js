/*!
* jQuery Form Plugin
* version: 3.09 (16-APR-2012)
* @requires jQuery v1.3.2 or later
*
* Examples and documentation at: http://malsup.com/jquery/form/
* Project repository: https://github.com/malsup/form
* Dual licensed under the MIT and GPL licenses:
*    http://malsup.github.com/mit-license.txt
*    http://malsup.github.com/gpl-license-v2.txt
*/
(function(n){"use strict";function r(t){var i=t.data;t.isDefaultPrevented()||(t.preventDefault(),n(this).ajaxSubmit(i))}function u(t){var r=t.target,f=n(r),e,i,u;if(!f.is(":submit,input:image")){e=f.closest(":submit");if(e.length===0)return;r=e[0]}i=this,i.clk=r,r.type=="image"&&(t.offsetX!==undefined?(i.clk_x=t.offsetX,i.clk_y=t.offsetY):typeof n.fn.offset=="function"?(u=f.offset(),i.clk_x=t.pageX-u.left,i.clk_y=t.pageY-u.top):(i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop)),setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function t(){if(!n.fn.ajaxSubmit.debug)return;var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}var i={};i.fileapi=n("<input type='file'/>").get(0).files!==undefined,i.formdata=window.FormData!==undefined,n.fn.ajaxSubmit=function(r){function rt(t){for(var o=new FormData,f,i,e,u=0;u<t.length;u++)o.append(t[u].name,t[u].value);if(r.extraData)for(f in r.extraData)r.extraData.hasOwnProperty(f)&&o.append(f,r.extraData[f]);r.data=null,i=n.extend(!0,{},n.ajaxSettings,r,{contentType:!1,processData:!1,cache:!1,type:"POST"}),r.uploadProgress&&(i.xhr=function(){var n=jQuery.ajaxSettings.xhr();return n.upload&&(n.upload.onprogress=function(n){var u=0,i=n.loaded||n.position,t=n.total;n.lengthComputable&&(u=Math.ceil(i/t*100)),r.uploadProgress(n,i,t,u)}),n}),i.data=null,e=i.beforeSend,i.beforeSend=function(n,t){t.data=o,e&&e.call(t,n,r)},n.ajax(i)}function b(i){function ot(n){return n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document}function st(){function s(){try{var n=ot(c).readyState;t("state = "+n),n&&n.toLowerCase()=="uninitialized"&&setTimeout(s,50)}catch(i){t("Server abort: ",i," (",i.name,")"),p(d),b&&clearTimeout(b),b=undefined}}var e=u.attr("target"),o=u.attr("action"),r,i;h.setAttribute("target",k),l||h.setAttribute("method","POST"),o!=f.url&&h.setAttribute("action",f.url),f.skipEncodingOverride||l&&!/post/i.test(l)||u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(b=setTimeout(function(){ut=!0,p(rt)},f.timeout)),r=[];try{if(f.extraData)for(i in f.extraData)f.extraData.hasOwnProperty(i)&&r.push(n('<input type="hidden" name="'+i+'">').attr("value",f.extraData[i]).appendTo(h)[0]);f.iframeTarget||(a.appendTo("body"),c.attachEvent?c.attachEvent("onload",p):c.addEventListener("load",p,!1)),setTimeout(s,15),h.submit()}finally{h.setAttribute("action",o),e?h.setAttribute("target",e):u.removeAttr("target"),n(r).remove()}}function p(i){var r,s,w,u,k,g,h,l,v;if(e.aborted||et)return;try{o=ot(c)}catch(nt){t("cannot access response document: ",nt),i=d}if(i===rt&&e){e.abort("timeout");return}if(i==d&&e){e.abort("server abort");return}if(!o||o.location.href==f.iframeSrc)if(!ut)return;c.detachEvent?c.detachEvent("onload",p):c.removeEventListener("load",p,!1),r="success";try{if(ut)throw"timeout";w=f.dataType=="xml"||o.XMLDocument||n.isXMLDoc(o),t("isXml="+w);if(!w&&window.opera&&(o.body===null||!o.body.innerHTML))if(--ft){t("requeing onLoad callback, DOM not available"),setTimeout(p,250);return}u=o.body?o.body:o.documentElement,e.responseText=u?u.innerHTML:null,e.responseXML=o.XMLDocument?o.XMLDocument:o,w&&(f.dataType="xml"),e.getResponseHeader=function(n){var t={"content-type":f.dataType};return t[n]},u&&(e.status=Number(u.getAttribute("status"))||e.status,e.statusText=u.getAttribute("statusText")||e.statusText),k=(f.dataType||"").toLowerCase(),g=/(json|script|text)/.test(k),g||f.textarea?(h=o.getElementsByTagName("textarea")[0],h?(e.responseText=h.value,e.status=Number(h.getAttribute("status"))||e.status,e.statusText=h.getAttribute("statusText")||e.statusText):g&&(l=o.getElementsByTagName("pre")[0],v=o.getElementsByTagName("body")[0],l?e.responseText=l.textContent?l.textContent:l.innerText:v&&(e.responseText=v.textContent?v.textContent:v.innerText))):k=="xml"&&!e.responseXML&&e.responseText&&(e.responseXML=vt(e.responseText));try{ht=lt(e,k,f)}catch(i){r="parsererror",e.error=s=i||r}}catch(i){t("error caught: ",i),r="error",e.error=s=i||r}e.aborted&&(t("upload aborted"),r=null),e.status&&(r=e.status>=200&&e.status<300||e.status===304?"success":"error"),r==="success"?(f.success&&f.success.call(f.context,ht,"success",e),y&&n.event.trigger("ajaxSuccess",[e,f])):r&&(s===undefined&&(s=e.statusText),f.error&&f.error.call(f.context,e,r,s),y&&n.event.trigger("ajaxError",[e,f,s])),y&&n.event.trigger("ajaxComplete",[e,f]),y&&!--n.active&&n.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,e,r),et=!0,f.timeout&&clearTimeout(b),setTimeout(function(){f.iframeTarget||a.remove(),e.responseXML=null},100)}var h=u[0],tt,g,f,y,k,a,c,e,w,v,ut,b,at=!!n.fn.prop,rt,d,nt,it,ht,o,ft,et;if(n(":input[name=submit],:input[id=submit]",h).length){alert('Error: Form elements must not have name or id of "submit".');return}if(i)for(g=0;g<s.length;g++)tt=n(s[g]),at?tt.prop("disabled",!1):tt.removeAttr("disabled");f=n.extend(!0,{},n.ajaxSettings,r),f.context=f.context||f,k="jqFormIO"+ +new Date,f.iframeTarget?(a=n(f.iframeTarget),v=a.attr("name"),v?k=v:a.attr("name",k)):(a=n('<iframe name="'+k+'" src="'+f.iframeSrc+'" />'),a.css({position:"absolute",top:"-1000px",left:"-1000px"})),c=a[0],e={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(i){var r=i==="timeout"?"timeout":"aborted";t("aborting upload... "+r),this.aborted=1,a.attr("src",f.iframeSrc),e.error=r,f.error&&f.error.call(f.context,e,r,i),y&&n.event.trigger("ajaxError",[e,f,r]),f.complete&&f.complete.call(f.context,e,r)}},y=f.global,y&&0==n.active++&&n.event.trigger("ajaxStart"),y&&n.event.trigger("ajaxSend",[e,f]);if(f.beforeSend&&f.beforeSend.call(f.context,e,f)===!1){f.global&&n.active--;return}if(e.aborted)return;w=h.clk,w&&(v=w.name,v&&!w.disabled&&(f.extraData=f.extraData||{},f.extraData[v]=w.value,w.type=="image"&&(f.extraData[v+".x"]=h.clk_x,f.extraData[v+".y"]=h.clk_y))),rt=1,d=2,nt=n("meta[name=csrf-token]").attr("content"),it=n("meta[name=csrf-param]").attr("content"),it&&nt&&(f.extraData=f.extraData||{},f.extraData[it]=nt),f.forceSync?st():setTimeout(st,10),ft=50;var vt=n.parseXML||function(n,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)):t=(new DOMParser).parseFromString(n,"text/xml"),t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},ct=n.parseJSON||function(n){return window.eval("("+n+")")},lt=function(t,i,r){var f=t.getResponseHeader("content-type")||"",e=i==="xml"||!i&&f.indexOf("xml")>=0,u=e?t.responseXML:t.responseText;return e&&u.documentElement.nodeName==="parsererror"&&n.error&&n.error("parsererror"),r&&r.dataFilter&&(u=r.dataFilter(u,i)),typeof u=="string"&&(i!=="json"&&(i||f.indexOf("json")<0)?i!=="script"&&(i||f.indexOf("javascript")<0)||n.globalEval(u):u=ct(u)),u}}var l,w,e,u,c,a,s,v,f,h,o,g,k,y;if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;u=this,typeof r=="function"&&(r={success:r}),l=this.attr("method"),w=this.attr("action"),e=typeof w=="string"?n.trim(w):"",e=e||window.location.href||"",e&&(e=(e.match(/^([^#]+)/)||[])[1]),r=n.extend(!0,{url:e,success:n.ajaxSettings.success,type:l||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},r),c={},this.trigger("form-pre-serialize",[this,r,c]);if(c.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(r.beforeSerialize&&r.beforeSerialize(this,r)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;a=r.traditional,a===undefined&&(a=n.ajaxSettings.traditional),s=[],f=this.formToArray(r.semantic,s),r.data&&(r.extraData=r.data,v=n.param(r.data,a));if(r.beforeSubmit&&r.beforeSubmit(f,this,r)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[f,this,r,c]);if(c.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;h=n.param(f,a),v&&(h=h?h+"&"+v:v),r.type.toUpperCase()=="GET"?(r.url+=(r.url.indexOf("?")>=0?"&":"?")+h,r.data=null):r.data=h,o=[],r.resetForm&&o.push(function(){u.resetForm()}),r.clearForm&&o.push(function(){u.clearForm(r.includeHidden)}),!r.dataType&&r.target?(g=r.success||function(){},o.push(function(t){var i=r.replaceTarget?"replaceWith":"html";n(r.target)[i](t).each(g,arguments)})):r.success&&o.push(r.success),r.success=function(n,t,i){for(var s=r.context||r,f=0,e=o.length;f<e;f++)o[f].apply(s,[n,t,i||u,u])};var it=n("input:file:enabled[value]",this),nt=it.length>0,tt="multipart/form-data",d=u.attr("enctype")==tt||u.attr("encoding")==tt,p=i.fileapi&&i.formdata;for(t("fileAPI :"+p),k=(nt||d)&&!p,r.iframe!==!1&&(r.iframe||k)?r.closeKeepAlive?n.get(r.closeKeepAlive,function(){b(f)}):b(f):(nt||d)&&p?rt(f):n.ajax(r),y=0;y<s.length;y++)s[y]=null;return this.trigger("form-submit-notify",[this,r]),this},n.fn.ajaxForm=function(i){i=i||{},i.delegation=i.delegation&&n.isFunction(n.fn.on);if(!i.delegation&&this.length===0){var f={s:this.selector,c:this.context};return!n.isReady&&f.s?(t("DOM not ready, queuing ajaxForm"),n(function(){n(f.s,f.c).ajaxForm(i)}),this):(t("terminating; zero elements found by selector"+(n.isReady?"":" (DOM not ready)")),this)}if(i.delegation){n(document).off("submit.form-plugin",this.selector,r).off("click.form-plugin",this.selector,u).on("submit.form-plugin",this.selector,i,r).on("click.form-plugin",this.selector,i,u);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",i,r).bind("click.form-plugin",i,u)},n.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},n.fn.formToArray=function(t,r){var o=[],e,v,a,h,f,s,u,p,w,c,y,l;if(this.length===0)return o;e=this[0],v=t?e.getElementsByTagName("*"):e.elements;if(!v)return o;for(a=0,p=v.length;a<p;a++){u=v[a],f=u.name;if(!f)continue;if(t&&e.clk&&u.type=="image"){u.disabled||e.clk!=u||(o.push({name:f,value:n(u).val(),type:u.type}),o.push({name:f+".x",value:e.clk_x},{name:f+".y",value:e.clk_y}));continue}s=n.fieldValue(u,!0);if(s&&s.constructor==Array)for(r&&r.push(u),h=0,w=s.length;h<w;h++)o.push({name:f,value:s[h]});else if(i.fileapi&&u.type=="file"&&!u.disabled){r&&r.push(u),c=u.files;if(c.length)for(h=0;h<c.length;h++)o.push({name:f,value:c[h],type:u.type});else o.push({name:f,value:"",type:u.type})}else s!==null&&typeof s!="undefined"&&(r&&r.push(u),o.push({name:f,value:s,type:u.type,required:u.required}))}return!t&&e.clk&&(y=n(e.clk),l=y[0],f=l.name,f&&!l.disabled&&l.type=="image"&&(o.push({name:f,value:y.val()}),o.push({name:f+".x",value:e.clk_x},{name:f+".y",value:e.clk_y}))),o},n.fn.formSerialize=function(t){return n.param(this.formToArray(t))},n.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var e=this.name,r,u,f;if(!e)return;r=n.fieldValue(this,t);if(r&&r.constructor==Array)for(u=0,f=r.length;u<f;u++)i.push({name:e,value:r[u]});else r!==null&&typeof r!="undefined"&&i.push({name:this.name,value:r})}),n.param(i)},n.fn.fieldValue=function(t){for(var f,i,u=[],r=0,e=this.length;r<e;r++){f=this[r],i=n.fieldValue(f,t);if(i===null||typeof i=="undefined"||i.constructor==Array&&!i.length)continue;i.constructor==Array?n.merge(u,i):u.push(i)}return u},n.fieldValue=function(t,i){var v=t.name,u=t.type,h=t.tagName.toLowerCase(),o,e,r,f;i===undefined&&(i=!0);if(i&&(!v||t.disabled||u=="reset"||u=="button"||(u=="checkbox"||u=="radio")&&!t.checked||(u=="submit"||u=="image")&&t.form&&t.form.clk!=t||h=="select"&&t.selectedIndex==-1))return null;if(h=="select"){o=t.selectedIndex;if(o<0)return null;var c=[],l=t.options,s=u=="select-one",a=s?o+1:l.length;for(e=s?o:0;e<a;e++){r=l[e];if(r.selected){f=r.value,f||(f=r.attributes&&r.attributes.value&&!r.attributes.value.specified?r.text:r.value);if(s)return f;c.push(f)}}return c}return n(t).val()},n.fn.clearForm=function(t){return this.each(function(){n("input,select,textarea",this).clearFields(t)})},n.fn.clearFields=n.fn.clearInputs=function(t){var i=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,u=this.tagName.toLowerCase();i.test(r)||u=="textarea"?this.value="":r=="checkbox"||r=="radio"?this.checked=!1:u=="select"?this.selectedIndex=-1:t&&(t===!0&&/hidden/.test(r)||typeof t=="string"&&n(this).is(t))&&(this.value="")})},n.fn.resetForm=function(){return this.each(function(){typeof this.reset!="function"&&(typeof this.reset!="object"||this.reset.nodeType)||this.reset()})},n.fn.enable=function(n){return n===undefined&&(n=!0),this.each(function(){this.disabled=!n})},n.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var r=this.type,i;r=="checkbox"||r=="radio"?this.checked=t:this.tagName.toLowerCase()=="option"&&(i=n(this).parent("select"),t&&i[0]&&i[0].type=="select-one"&&i.find("option").selected(!1),this.selected=t)})},n.fn.ajaxSubmit.debug=!1})(jQuery)